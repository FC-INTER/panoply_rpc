/*
 * This is sample code generated by rpcgen.
 * These are only templates and you can use them
 * as a guideline for developing your own functions.
 */

#include "panoply.h"

panoply *
init_1_svc(panoply *argp, struct svc_req *rqstp)
{
	static panoply  result;

	/*init abonnements*/
    argp->abonnements.nb_different_abonnement=4;

        /* ~Abonnement n°1~ */
        argp->abonnements.abonnements[0].id_abo = 0;
        strcpy(argp->abonnements.abonnements[0].type_abo,"Un peu");
        argp->abonnements.abonnements[0].prix_abo=69;
        argp->abonnements.abonnements[0].credit_abo=1;

        /* ~Abonnement n°2~ */
        argp->abonnements.abonnements[1].id_abo = 1;
        strcpy(argp->abonnements.abonnements[0].type_abo,"Beaucoup");
        argp->abonnements.abonnements[0].prix_abo=159;
        argp->abonnements.abonnements[0].credit_abo=3;

        /* ~Abonnement n°3~ */
        argp->abonnements.abonnements[2].id_abo = 2;
        strcpy(argp->abonnements.abonnements[0].type_abo,"Passionnément");
        argp->abonnements.abonnements[0].prix_abo=229;
        argp->abonnements.abonnements[0].credit_abo=5;

        /* ~Abonnement n°4~ */
        argp->abonnements.abonnements[3].id_abo = 3;
        strcpy(argp->abonnements.abonnements[0].type_abo,"A la folie");
        argp->abonnements.abonnements[0].prix_abo=319;
        argp->abonnements.abonnements[0].credit_abo=8;    
    
    /*init collections*/
    argp->collections.nb_different_collection=2;
    
        /* ~Collection n°1~ */
        argp->collections.collection[0].id_collection=0;
        strcpy(argp->collections.collection[0].nom_collection,"Robes longues");

        /* ~Collection n°2~ */
        argp->collections.collection[1].id_collection=1;
        strcpy(argp->collections.collection[1].nom_collection,"Robes mini");

    /*init marques*/
    argp->marques.nb_different_brand=2;

        /* ~Marques n°1~ */
        argp->marques.brands[0].id_brand=0;
        strcpy(argp->marques.brands[0].brand_name,"3.1 Phillip Lim");
        strcpy(argp->marques.brands[0].description,"Un style classique maitrisé associé à une touche sportwear définit l'identité de la maison 3.1 Phillip Lim.\n\nLe minimalisme des pièces et la palette de couleurs restreinte focalisent l'attention sur des coupes structurées et des détails originaux mis en valeur par des matières nobles et texturées pour une femme libre et naturellement chic.");

        /* ~Marques n°2~ */
        argp->marques.brands[1].id_brand=1;
        strcpy(argp->marques.brands[1].brand_name,"Alexis Mabille");
        strcpy(argp->marques.brands[1].description,"Formé aux côtés de Hedi Slimane chez Dior, Alexis Mabille s'intéresse particulièrement à l'androgynie et aux frontières du masculin et du féminin. Il lance sa griffe en 2005 et crée des collections unisexes remarquées du milieu de la mode. Il revisite le nœud papillon en jouant sur les volumes et cet accessoire désuet devient sa marque de fabrique.");

    /*init articles*/
    argp->articles.nb_different_article=5;
   
       /* ~Article n°1~ */
       argp->articles.article[0].id_article = 0; 
       strcpy(argp->articles.article[0].nom,"Flower dress");
       argp->articles.article[0].taille[0]=34;
       argp->articles.article[0].taille[1]=38;
       argp->articles.article[0].taille[2]=42;
       argp->articles.article[0].taille[3]=-1;        
       argp->articles.article[0].pt_livraison=1;
       argp->articles.article[0].prix_location=55;       
       argp->articles.article[0].collection_reference=argp->collections.collection[0];                   
       argp->articles.article[0].brand_reference = argp->marques.brands[1];
       argp->articles.article[0].credit=1;
       argp->articles.article[0].stock=5;

    /*init comptes*/
    argp->comptes.nbCompte=1;

        /* ~compte n°1~ */
        argp->comptes.cmpt[0].id_compte=0;
        strcpy(argp->comptes.cmpt[0].email.email,"client1@univ-brest.fr"); 
        strcpy(argp->comptes.cmpt[0].mdp.mdp,"client1"); 
        strcpy(argp->comptes.cmpt[0].nom,"masse");
        strcpy(argp->comptes.cmpt[0].prenom,"damien");
        argp->comptes.cmpt[0].date_de_naissance.jour = 2;
        argp->comptes.cmpt[0].date_de_naissance.mois = 5;
        argp->comptes.cmpt[0].date_de_naissance.annee = 1975;
        argp->comptes.cmpt[0].telephone = 655482746;
        strcpy(argp->comptes.cmpt[0].profession,"maitre de conf");
        strcpy(argp->comptes.cmpt[0].pays,"france");
        strcpy(argp->comptes.cmpt[0].code_promo,"DS4T56");
        argp->comptes.cmpt[0].nb_credit=7;
        argp->comptes.cmpt[0].connaissance = 1;
        argp->comptes.cmpt[0].abonnement_suivi.abonnements[1]= argp->abonnements.abonnements[0];


    /*init commandes*/
    argp->commandes.nbCommande=0;

    result=*argp;

	return &result;
}

compte *
create_account_1_svc(void *argp, struct svc_req *rqstp)
{
	static compte  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
log_in_1_svc(identifiants *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
list_all_collection_1_svc(list_collection *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
list_all_collection_clothes_1_svc(list_collection *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

list_collection *
add_cloth_to_collection_1_svc(list_collection *argp, struct svc_req *rqstp)
{
	static list_collection  result;

	/*
	 * insert server code here
	 */

	return &result;
}

list_collection *
remove_cloth_to_collection_1_svc(list_collection *argp, struct svc_req *rqstp)
{
	static list_collection  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
list_type_abo_1_svc(list_abonnement *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

compte *
affecter_abo_client_1_svc(compte *argp, struct svc_req *rqstp)
{
	static compte  result;

	/*
	 * insert server code here
	 */

	return &result;
}

compte *
modif_abo_1_svc(compte *argp, struct svc_req *rqstp)
{
	static compte  result;

	/*
	 * insert server code here
	 */

	return &result;
}

list_abonnement *
add_subscription_1_svc(list_abonnement *argp, struct svc_req *rqstp)
{
	static list_abonnement  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
display_abonnement_1_svc(abonnement *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

article_list *
add_article_1_svc(article_list *argp, struct svc_req *rqstp)
{
	static article_list  result;

	/*
	 * insert server code here
	 */

	return &result;
}

article_list *
update_article_1_svc(article_list *argp, struct svc_req *rqstp)
{
	static article_list  result;

	/*
	 * insert server code here
	 */

	return &result;
}

article_list *
delete_article_1_svc(article_list *argp, struct svc_req *rqstp)
{
	static article_list  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
fetch_article_1_svc(article_list *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
list_all_brand_1_svc(list_brand *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

list_brand *
add_brand_1_svc(list_brand *argp, struct svc_req *rqstp)
{
	static list_brand  result;

	/*
	 * insert server code here
	 */

	return &result;
}

list_brand *
delete_brand_1_svc(list_brand *argp, struct svc_req *rqstp)
{
	static list_brand  result;

	/*
	 * insert server code here
	 */

	return &result;
}

list_brand *
update_brand_1_svc(list_brand *argp, struct svc_req *rqstp)
{
	static list_brand  result;

	/*
	 * insert server code here
	 */

	return &result;
}

void *
list_all_cart_1_svc(cart *argp, struct svc_req *rqstp)
{
	static char * result;

	int i;

	printf("Vos articles dans votre panier : \n");
	for(i=0;i<argp->nbArticle-1;i++){
		printf("	%d - %s \n",i,argp->list_article[i].nom);
	}

	return (void *) &result;
}

cart *
add_to_cart_1_svc(cart *argp, struct svc_req *rqstp)
{
	static cart  result;

	

	return &result;
}

panoply * rent_1_svc(panoply *argp, struct svc_req *rqstp)
{
	static panoply  result;

	char confirmation;
	char payement;
	int id,nb_article,i,indice_article,stock;
	struct article passage;


	printf("---------------------------------------------------\n");
	printf("Quel est votre identifiant ?\n");
	scanf("%d",&id);
	printf("Etes vous sur de vouloir louer ce(s) vêtement ? (y/n)\n");
	scanf("%s",&confirmation);
	if (confirmation == 'y'){
		printf("Prix en euro : %d\n",argp->commandes.listCommande[id].list_article[id].prix_location);
		printf("Prix jeton : %d\n",argp->commandes.listCommande[id].list_article[id].prix_location);
		printf("Voulez vous payer en jeton ou en euros ? (j/e)\n");
		scanf("%s",&payement);
		if(payement == 'j'){
			argp->comptes.cmpt[id].nb_credit--;
			printf("Payement effectué\n");
			nb_article=argp->commandes.listCommande[id].nbArticle;
			printf("Mise à jour des stock\n");
			for (i = 0 ; i<nb_article ; i++ ){

				indice_article=argp->commandes.listCommande[id].list_article[i].id_article;
				stock=argp->commandes.listCommande[id].list_article[i].stock;
				printf("	article : %s | indice : %d |stock : %d\n",argp->commandes.listCommande[id].list_article[i].nom,indice_article,stock);
				stock = argp->articles.article[indice_article-1].stock;
				stock--;
				printf("	article : %s | indice : %d |stock : %d\n",argp->articles.article[indice_article-1].nom,indice_article-1,stock);

			}
			printf("\n");
			printf("Suppression du panier\n");
			for (int i =id; argp->commandes.listCommande[id].nbArticle-2; i++){
				passage=argp->commandes.listCommande[id].list_article[i];
				argp->commandes.listCommande[id].list_article[i]=argp->commandes.listCommande[id].list_article[i+1];
				argp->commandes.listCommande[id].list_article[i+1]=passage;		
			}	
			argp->commandes.listCommande[id].nbArticle--;
			printf("Panier supprime\n");
		}
		else if (payement == 'e'){
			printf("Payement effectué, votre moula est partie\n");
			nb_article=argp->commandes.listCommande[id].nbArticle;
			printf("Mise à jour des stock\n");
			for (i = 0 ; i<nb_article ; i++ ){

				indice_article=argp->commandes.listCommande[id].list_article[i].id_article;
				stock=argp->commandes.listCommande[id].list_article[i].stock;
				printf("	article : %s | indice : %d |stock : %d\n",argp->commandes.listCommande[id].list_article[i].nom,indice_article,stock);
				stock = argp->articles.article[indice_article-1].stock;
				stock--;
				printf("	article : %s | indice : %d |stock : %d\n",argp->articles.article[indice_article-1].nom,indice_article-1,stock);

			}
			printf("\n");
			printf("Suppression du panier\n");
			for (int i =id; argp->commandes.listCommande[id].nbArticle-2; i++){
				passage=argp->commandes.listCommande[id].list_article[i];
				argp->commandes.listCommande[id].list_article[i]=argp->commandes.listCommande[id].list_article[i+1];
				argp->commandes.listCommande[id].list_article[i+1]=passage;		
			}	
			argp->commandes.listCommande[id].nbArticle--;
			printf("Panier supprime\n");
		}
		else{
			printf("vous ne savez pas taper sur votre ordi èé");
		}
	}
	else  if (confirmation == 'n') {
		printf("Vous avez renoncé à la location");
	}
	else{
		printf("vous ne savez pas taper sur votre ordi èé");
	}
	
	printf("---------------------------------------------------\n");

	return &result;
}

cart *
remove_from_cart_1_svc(cart *argp, struct svc_req *rqstp)
{
	static cart  result;
	int indice;
	struct article passage;


	printf("---------------------------------------------------\n");
	list_all_cart_1_svc(argp,rqstp);
	printf("Indiquez l'indice de l'article à supprimer : \n");
	scanf("%d",&indice);
	for (int i =indice; argp->nbArticle-2; i++){
		passage=argp->list_article[i];
		argp->list_article[i]=argp->list_article[i+1];
		argp->list_article[i+1]=passage;		
	}	
	argp->nbArticle--;
	printf("Article supprimé\n");
	printf("---------------------------------------------------\n");

	return &result;
}
